"use strict";function Vec(t,n){this.x=t,this.y=n}function Engine(t,n){this.id=null,this.updateFunc=null;var a=this;function i(){t.clearRect(0,0,n.w,n.h),a.updateFunc&&a.updateFunc(t),a.id=requestAnimationFrame(i)}this.ctx=t,this.start=function(){this.id=requestAnimationFrame(i)},this.stop=function(){cancelAnimationFrame(this.id),this.id=null},this.draw=function(t,n,i,e){a.ctx.save(),a.ctx.translate(t,n),a.ctx.rotate(i?i*(Math.PI/180):0),e&&e(a.ctx),a.ctx.restore()}}Vec.prototype={set:function(t){return this.x=t.x,this.y=t.y,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},relativeMagnitude:function(t){var n=t.x-this.x,i=t.y-this.y;return Math.sqrt(n*n+i*i)},setAngle:function(t){var n=t*(Math.PI/180);return new Vec(this.x*Math.cos(n),this.y*Math.sin(n))},relativeAngle:function(t){var n=t.x-this.x,i=t.y-this.y;return Math.atan2(i,n)},relative:function(t){return new Vec(t.x-this.x,t.y-this.y)}},function(){for(var s=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),e=Math.max(0,16-(i-s)),a=window.setTimeout(function(){t(i+e)},e);return s=i+e,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),Engine.prototype.update=function(t){this.updateFunc=t};var utils={degToRad:function(t){return t*(Math.PI/180)},radToDeg:function(t){return 180/Math.PI*t},random:function(t,n){return Math.floor(Math.random()*(n-t)+t)}};function keyboardEvents(){this.map={},this.handler=null;var n=this;function t(t){n.map[t.keyCode]="keydown"==t.type,n.handler&&n.handler(n.map)}this.setup=function(){return document.addEventListener("keyup",t),document.addEventListener("keydown",t),this},this.listen=function(t){this.handler=t}}function CanvasEngine(t,n,i,e){this.canvas=t,this.ctx=t.getContext("2d"),this.canvas.width=n,this.canvas.height=i,this.canvas.style.backgroundColor=e,this.vars={w:n,h:i,wh:n/2,hh:i/2},this.utils=utils,this.Vec=Vec,this.Engine=new Engine(this.ctx,{w:n,h:i}),this.keyboardEvents=new keyboardEvents,this.ctx.globalAlpha=1}window.CanvasEngine=CanvasEngine;
