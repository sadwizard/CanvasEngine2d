"use strict";function Vec(t,n){this.x=t,this.y=n}function Engine(n,i){this.id=null,this.FPS=1e3/60,this.updateFunc=null;var s=this;function e(){var t=Date.now();s.updateFunc&&t-s.time>=s.FPS&&(n.clearRect(0,0,i.w,i.h),s.updateFunc(n,t),s.time=t),s.id=requestAnimationFrame(e)}this.ctx=n,this.time=null,this.start=function(){this.time=Date.now(),this.id=requestAnimationFrame(e)},this.stop=function(){cancelAnimationFrame(this.id),this.time=null,this.id=null},this.draw=function(t,n,i,e){s.ctx.save(),s.ctx.translate(t,n),s.ctx.rotate(i?i*(Math.PI/180):0),e&&e(s.ctx),s.ctx.restore()}}Vec.fromNumber=function(t){return new Vec(t,t)},Vec.prototype={set:function(t){return this.x=t.x,this.y=t.y,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},decrease:function(t){return this.x=0<this.x?this.x-t.x:this.x+t.x,this.y=0<this.y?this.y-t.y:this.y+t.y,this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},relativeMagnitude:function(t){var n=t.x-this.x,i=t.y-this.y;return Math.sqrt(n*n+i*i)},setAngle:function(t){var n=t*(Math.PI/180);return new Vec(this.x*Math.cos(n),this.y*Math.sin(n))},relativeAngle:function(t){var n=t.x-this.x,i=t.y-this.y;return Math.atan2(i,n)},relative:function(t){return new Vec(t.x-this.x,t.y-this.y)},negativeX:function(){return this.x*=-1,this},negativeY:function(){return this.y*=-1,this},negative:function(t){return this.x*=-1,this.y*=-1,this}},function(){for(var a=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),e=Math.max(0,16-(i-a)),s=window.setTimeout(function(){t(i+e)},e);return a=i+e,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),Engine.prototype.update=function(t){this.updateFunc=t};var utils={degToRad:function(t){return t*(Math.PI/180)},radToDeg:function(t){return 180/Math.PI*t},random:function(t,n){return Math.floor(Math.random()*(n-t)+t)}};function keyboardEvents(){this.map={},this.handler=null;var n=this;function t(t){n.map[t.keyCode]="keydown"==t.type,n.handler&&n.handler(n.map)}this.setup=function(){return document.addEventListener("keyup",t),document.addEventListener("keydown",t),this},this.listen=function(t){this.handler=t}}function CanvasEngine(t,n,i,e){this.canvas=t,this.ctx=t.getContext("2d"),this.canvas.width=n,this.canvas.height=i,this.canvas.style.backgroundColor=e,this.vars={w:n,h:i,wh:n/2,hh:i/2},this.utils=utils,this.Vec=Vec,this.Engine=new Engine(this.ctx,{w:n,h:i}),this.keyboardEvents=new keyboardEvents,this.ctx.globalAlpha=1}window.CanvasEngine=CanvasEngine;
